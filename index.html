<!DOCTYPE html>
<html lang="en">

<head>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable = no">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">
<title>Minecraft Gradient Generator</title>
<style>

body {
  font-family: 'Poppins', Arial, sans-serif;
  background-color: rgb(10,0,25);
  color: #fff;
  padding: 0; /* Remove padding around the container */
  margin: 0; /* Remove margin around the container */
  display: flex;
  justify-content: center;
  overflow-x: hidden;
  touch-action: pan-x pan-y;
}
div {
    font-family: 'Poppins', Arial, sans-serif;
}
button {
  background-color: rgba(255, 255, 255, 0.05);
  border: none;
  outline: rgba(255, 255, 255, 0.2) solid 1.5px;
  color: white;
  padding: 15px 32px;
  text-align: center;
  font-size: 16px;
  margin: 4px 2px;
  cursor: pointer;
  border-radius:10px;
  font-weight: bold;
}
input{
    font-family: 'Poppins', Arial, sans-serif;
}
button:hover {
  outline: rgba(255, 255, 255, 0.3) solid 2.5px;
  background-color: rgba(255, 255, 255, 0.1);
}
#result {
    margin-top: 20px;
    font-weight: bold;
}

#blocksContainer {
    display: flex; /* Use flexbox to arrange elements */
    flex-direction: row; /* Arrange elements in a column (vertical direction) */
    padding: 0; /* Remove padding around the container */
    margin: 0; /* Remove margin around the container */
    position: relative;
    top:0;
    left: 0;
}
#blocksPreviewContainer {
    display: flex; /* Use flexbox to arrange elements */
    flex-direction: row; /* Arrange elements in a column (vertical direction) */
    padding: 0; /* Remove padding around the container */
    margin: 0; /* Remove margin around the container */
    position: relative;
    top:0;
    left: 0;
}
.blockScalerContainer {
    transform-origin: 50% 0%;
    transform: scale(1);
    padding: 0; /* Remove padding around the container */
    margin: 0; /* Remove margin around the container */
    transition: transform 0.3s ease; /* Smooth transition for the scale change */
}

@keyframes rubberBand {
    0% {
        transform: scale(1);
    }
    50% {
        transform: scale(0.95); /* Slightly zoom out */
    }
    100% {
        transform: scale(1); /* Back to minimum scale */
    }
}

.blockAlignerContainer {
    width: 100vw;
    height: 10000px;
    display: flex;
    justify-content: center;
    overflow: hidden;
}
.rowContainer {
    display: flex; /* Use flexbox to arrange elements */
    flex-direction: column; /* Arrange elements in a column (vertical direction) */
    padding: 0; /* Remove padding around the container */
    margin: 0; /* Remove margin around the container */
}
.rowContainer-preview {
    position: absolute;
    left: -20px;
    top: 0;
}
.tinyBlock {
    display: block; /* Make sure images are treated as block elements */
    padding: 0; /* Remove any padding around images */
    margin: 0; /* Remove any margin around images */
    width: 20px; /* Set the width to 10px */
    aspect-ratio: 1 / 1; /* Maintain a square aspect ratio */
    image-rendering: -webkit-optimize-contrast; /* Chrome, Edge, Opera, and Safari */
    image-rendering: pixelated;
    /*box-shadow: 0px 10px,40px 0px, 80px 0px;*/
    cursor: pointer;
}
.tinyBlock:hover {
    z-index: 1;
    outline: rgba(255, 255, 255, 0.4) solid 2px;
}

.gradientControllerRightAligner {
    display: flex;
    justify-content: flex-end;
}

/* Slider styling */
.gradientController {
    width:100%;
    outline: rgba(255, 255, 255, 0.2) solid 1.5px;
    background-color: rgba(10,0,25,.7);
    -webkit-backdrop-filter: blur(10px);
    backdrop-filter: blur(10px);
    color: white;
    padding: 15px;
    font-size: 16px;
    border-radius: 30px;
    font-weight: bold;
    box-sizing: border-box;
    display: flex;
    flex-direction: column;
    gap:10px;
    pointer-events: auto;
    transition: gap 0.3s ease;
}
.settingsPanel {
    position: fixed;
    bottom: 20px;
    width: calc(100vw - 40px);
    right:20px;
    display: flex;
    flex-direction: column;
    gap:10px; 
    pointer-events: none;
}

@media screen and (min-width: 500px) {
    .gradientController {
      width: 350px;
    }
}

input[type="range"] {
    -webkit-appearance: none;
    width: 100%;
    height: 5px;
    background: rgba(255, 255, 255, 0.05);
    outline: rgba(255, 255, 255, 0.2) solid 1.5px;
    border-radius: 5px;
    cursor: pointer;
    margin: auto;
}

input[type="range"]::-webkit-slider-thumb {
    -webkit-appearance: none;
    appearance: none;
    width: 15px;
    height: 40px;
    background-color: rgba(80, 40, 100, 0.7);
    outline: rgb(120, 80, 130) solid 2px;
    border-radius: 5px;
    cursor: pointer;
    position: relative;
}

input[type="range"]::-moz-range-thumb {
    appearance: none;
    width: 15px;
    height: 40px;
    background-color: rgba(80, 40, 100, 0.7);
    outline: rgb(120, 80, 130) solid 2px;
    border-radius: 5px;
    cursor: pointer;
    position: relative;
}

input[type="range"]:focus {
    outline: none;
}
.slider {
    background-color: rgba(255, 255, 255, 0.05);
    border: none;
    outline: rgba(255, 255, 255, 0.2) solid 1.5px;
    color: white;
    border-radius: 20px;
    padding: 15px;
    margin-top:5px;
    display: flex;
    gap: 15px;
}
.sliderInput {
    background-color: rgba(255, 255, 255, 0.05);
    border: none;
    outline: rgba(255, 255, 255, 0.2) solid 1.5px;
    color: white;
    text-align: center;
    font-size: 16px;
    cursor: pointer;
    border-radius: 10px;
    width: 50px;
    aspect-ratio: 1 / 1;
    padding:0;
}
label {
    font-size: 12px;
    color: rgba(255, 255, 255, 0.5);
    font-weight: bold;
    margin-left: 10px;
}
input:hover {
    /*outline: rgba(255, 255, 255, 0.3) solid 2.5px;*/
    background-color: rgba(255, 255, 255, 0.1);
}
.zoomBtns {
    height:45px;
    display: flex;
    justify-content: flex-end;
    /* outline: rgba(255, 255, 255, 0.2) solid 1.5px; */
    background: none;
    /* background-color: rgb(10,0,25); */
    border-radius: 25px;
    gap:3px;
}
.halfBtn {
    width:50px;
    padding:0;
    margin:0;
    outline: rgba(255, 255, 255, 0.2) solid 1.5px;
    background-color: rgba(10,0,25,0.7);
    -webkit-backdrop-filter: blur(5px);
    backdrop-filter: blur(5px);
    align-items: center;
    pointer-events: auto;
}
.halfBtn:hover {
    background-color: rgba(65,50,80,0.7);
}
#zoomOut {
    border-radius: 5px 25px 25px 5px;
}
#zoomIn {
    border-radius: 25px 5px 5px 25px;
}
.BtnAndLabelContainer {
    display: flex;
    flex-direction: column;
}
.blockSelectRow {
    display: flex;
    gap:6px;
    width: 100%;
    flex-wrap: wrap;
}
.dropdownBtn {
    width: 80px;
    height: 50px;
    border-radius: 25px;
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 7px;
    padding: 0;
}
.refreshBtn {
    min-width: 50px;
    height: 50px;
    border-radius: 10px;
    display: flex;
    justify-content: center;
    align-items: center;
    padding:0;
    gap:6px;
}
.refreshBtnContainer {
    flex: 1;
}
#refreshLabel {
    text-align: right; 
    margin-right: 10px;
}
.dropdownBlock {
    display: block; /* Make sure images are treated as block elements */
    padding: 0; /* Remove any padding around images */
    margin: 0; /* Remove any margin around images */
    width: 30px; /* Set the width to 10px */
    aspect-ratio: 1 / 1; /* Maintain a square aspect ratio */
    image-rendering: -webkit-optimize-contrast; /* Chrome, Edge, Opera, and Safari */
    image-rendering: pixelated;
    border-radius: 5px;
    outline: rgba(255, 255, 255, 0.2) solid 1.5px;
    outline-offset: 1px;
}
.dropdown-arrow {
    width: 17px;
    height: 10px;
    
}
.refreshSymbol {
  position: relative;
  top: -3px; /* Adjust this value as needed */
  font-size: 40px;
}

@media (min-width: 370px) {
  .refreshBtn::after {
    content: 'Refresh';
  }
}


.overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.7);
    z-index: 10;
    display: none; /* Initially hidden */
    justify-content: center;
    align-items: center;
}

.blockSelectionModal {
    height: 60%;
    outline: rgba(255, 255, 255, 0.2) solid 1.5px;
    background-color: rgba(10, 0, 25, 0.7);
    -webkit-backdrop-filter: blur(10px);
    backdrop-filter: blur(10px);
    color: white;
    padding: 15px;
    border-radius: 30px;
    display: none; /* Initially hidden */
    flex-direction: column;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 11;
    animation: fadeIn 0.5s;
    overflow: scroll;
    overflow-x: hidden;
}
.blockSelectionModal::-webkit-scrollbar {
  width: 5px;
}

/* Track */
.blockSelectionModal::-webkit-scrollbar-track {
  background: none; 
}
 
/* Handle */
.blockSelectionModal::-webkit-scrollbar-thumb {
  background: #888; 
}

/* Handle on hover */
.blockSelectionModal::-webkit-scrollbar-thumb:hover {
  background: #555; 
}
.modalHeader {
    width: 100px;
    display: flex;
    align-items: center;
    padding: 5px 5px 10px 5px;
    gap:5px;
    box-sizing:border-box;
}

.closeBtn {
    flex-shrink: 0;
    width: 40px;
    height: 40px;
    padding:0;
    background-color: rgba(255, 255, 255, 0.05);
    border: none;
    outline: rgba(255, 255, 255, 0.2) solid 1.5px;
    color: white;
    cursor: pointer;
    border-radius: 5px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.closeBtn svg {
    width: 15px;
    height: 15px;
}

.searchBar {
    flex: 1;
    margin:0;
    background-color: rgba(255, 255, 255, 0.05);
    border: none;
    outline: rgba(255, 255, 255, 0.2) solid 1.5px;
    color: white;
    padding: 0 0 0 8px;
    border-radius: 5px;
    font-size: 16px;
    align-items: center;
    height:40px;
    box-sizing: border-box; 
    min-width:0px;
}

.gridBlock {
    padding: 0;
    margin: 5px;
    width: 40px; /* Set the width to 40px */
    aspect-ratio: 1 / 1;
    image-rendering: -webkit-optimize-contrast;
    image-rendering: pixelated;
    cursor: pointer;
    outline-offset: 1px;
}

@keyframes fadeIn {
    from { opacity: 0; transform: translate(-50%, -60%); }
    to { opacity: 1; transform: translate(-50%, -50%); }
}

#gridContainer{
    display:flex;
    flex-wrap: wrap;
}

.gridBlock:hover {
  outline: rgba(255, 255, 255, 0.3) solid 2.5px;
}
#loadingOverlay {
  z-index: 50;
}
#blockNameDisplay {
  color: white;
  font-size: 12px;
  text-shadow: 0 0 5px black;
}
#clickToExcludeDisplay {
  color: white;
  font-size: 8px;
  text-shadow: 0 0 5px black;
  font-weight:600;
}
.blockNameContainer {
  position: fixed;
  top: 10px;
  left: 10px;
  z-index: 100;
  pointer-events: none; /* So it doesn't interfere with mouse events */
}
.blockModal {
  position: fixed;
  width: 80%;
  max-width: 400px;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  outline: rgba(255, 255, 255, 0.2) solid 1.5px;
  background-color: rgba(10, 0, 25, 0.7);
  -webkit-backdrop-filter: blur(10px);
  backdrop-filter: blur(10px);
  color: white;
  padding: 20px;
  border-radius: 30px;
  animation: fadeIn 0.5s;
  z-index: 12;
  display: none;
  flex-direction: row;
  align-items: center;
  gap:20px;
}

.blockModalContent {
  display: flex;
  flex-direction: column;
  justify-content: flex-end;
  height:120px;
  width:100%;
  gap:10px;
}

#modalBlockImage {
  width: 120px;
  height: 120px;
  image-rendering: pixelated;
  border-radius:10px;
}

#hideBlockButton {
  padding-left:0;
  padding-right:0;
}

#blockModalOverlay {
  z-index: 10;
}

.closeInfoBtn {
    position:absolute;
    top:10px;
    right:10px;
    outline:none;
    background:none;
    border-radius:50%;
}
#modalBlockName {
    width:calc(100% - 30px);
    overflow:hidden;
    text-transform: capitalize;
    font-weight: bold;
}
#hiddenBlocksContainer {
  position: fixed;
  top: 20px; /* Adjust as needed to not overlap with blockNameDisplay */
  right: 20px;
  display: flex;
  flex-direction: row-reverse;
  gap: 20px;
  z-index: 10;
  width:calc(100% - 40px);
  flex-wrap: wrap;
  pointer-events: none;
}

.hiddenBlockItem {
  position: relative;
  width: 40px;
  height: 40px;
  pointer-events: auto;
}

.hiddenBlockItem img {
  width: 100%;
  height: 100%;
  image-rendering: pixelated;
  border-radius: 5px;
  outline: rgba(200, 200, 200, 0.3) solid 1.5px;
  outline-offset: 1px;
  box-shadow: 0 0 8px 0 rgba(0, 0, 0, 0.2), 0 0 20px 0 rgba(0, 0, 0, 0.19);
}

.deleteBtn {
  position: absolute;
  top: -12px;
  right: -12px;
  width: 20px;
  height: 20px;
  background-color: rgba(200, 130, 210, 0.4);
  -webkit-backdrop-filter: blur(2px);
  backdrop-filter: blur(2px);
  color: black;
  outline: none;
  border-radius: 50%;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  padding:0;
}

.deleteBtn:hover {
    background-color: rgb(130, 80, 140);
}

.disappearingMessage {
    position: fixed;
    top: -50px;
    background-color: blue;
    color: white;
    padding: 5px 15px;
    border-radius: 4px;
    font-size: 14px;
    opacity: 0;
    transition: top 0.5s ease, opacity 0.5s ease;
    z-index: 1000;
    margin:0;
    text-align: center;
}

.persistentMessageContainer {
    position: fixed;
    top: -50px;
    background-color: blue;
    transition: top 0.5s ease, opacity 0.5s ease;
    display:flex;
    padding: 5px 38px 5px 10px;
    border-radius: 4px;
    opacity: 0;
    z-index: 1000;
    margin:0;
    max-width:90%;
}
.show {
    top: 10px;
    opacity: 1;
}
.persistentMessage{
    font-size: 14px;

}

/* When collapsed */
.collapsed #slidersContainer {
  max-height: 0;
  overflow: hidden;
}

/* When expanded */
#slidersContainer {
  max-height: 500px; /* Set to a value that can contain the content */
  transition: max-height 0.3s ease;
  display: flex;
  flex-direction: column;
  gap: 10px;
}
#toggleButton {
    position:fixed;
    top:3px;
    right:15px;
    padding:0;
    font-size:10px;
    display:flex;
    align-items: center;
    justify-content:center;
    height:23px;
    width:55px;
    font-size: 13px;
    color: rgba(255, 255, 255, 0.5);
    font-weight: 800;
    border-radius:13px;
}
.messageCloseBtn {
    position:absolute;
    top:1px;
    right:5px;
    height:25px;
    width:25px;
    padding:0;
    outline:none;
    background:none;
    display:flex;
    align-items:center;
    justify-content:center;
}
.messageCloseBtn svg {
    width: 15px;
    height: 15px;
}
</style>
</head>

<body>
  <div id="disappearingMessage" class="disappearingMessage hidden"></div>
  
  <div class="persistentMessageContainer" id="persistentMessageContainer">
    <div id="persistentMessage" class="persistentMessage hidden">ll</div>
    <button class="messageCloseBtn" onclick="hidePersistentMessage()">
        <svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
            <path d="M4 4 L16 16 M16 4 L4 16" stroke="lightGray" stroke-width="1.5" fill="none" stroke-linecap="round"/>
        </svg>
    </button>
  </div>

  <div class="blockNameContainer">
    <div id="blockNameDisplay"></div>
    <div id="clickToExcludeDisplay"></div>  
  </div>
  

  <div id="hiddenBlocksContainer"></div>

  <div class="blockAlignerContainer">
    <div class="blockScalerContainer">
      <div id="blocksPreviewContainer"></div>
      <div id="blocksContainer"></div>  
    </div>
  </div>

<div class="settingsPanel">
  <div class="zoomBtns">
    <button class="halfBtn" id="zoomIn" onclick="zoomIn()">+</button>
    <button class="halfBtn" id="zoomOut" onclick="zoomOut()">-</button>
  </div>
  <div class="gradientControllerRightAligner">
    <div class="gradientController">
        <button id="toggleButton" onclick="toggleGradientController()">LESS</button>
        <div class="blockSelectRow">
            <div class="BtnAndLabelContainer">
                <label>BLOCK 1</label>
                <button class="dropdownBtn">
                    <img class="dropdownBlock" src="https://raw.githubusercontent.com/ZtechNetwork/MCBVanillaResourcePack/master/textures/blocks/obsidian.png">
                    <svg class="dropdown-arrow" viewBox="0 0 20 10" xmlns="http://www.w3.org/2000/svg">
                        <path d="M2 2 L10 8 L18 2" stroke="rgb(150, 100, 160)" stroke-width="2.5" fill="none" stroke-linecap="round"/>
                    </svg>
                </button>
            </div>
            <div class="BtnAndLabelContainer">
                <label>BLOCK 2</label>
                <button class="dropdownBtn">
                    <img class="dropdownBlock" src="https://raw.githubusercontent.com/ZtechNetwork/MCBVanillaResourcePack/master/textures/blocks/coral_blue_dead.png">
                    <svg class="dropdown-arrow" viewBox="0 0 20 10" xmlns="http://www.w3.org/2000/svg">
                        <path d="M2 2 L10 8 L18 2" stroke="rgb(150, 100, 160)" stroke-width="2.5" fill="none" stroke-linecap="round"/>
                    </svg>
                </button>
            </div>
            <div class="BtnAndLabelContainer refreshBtnContainer">
                <label id="refreshLabel"> &nbsp</label>
                <button class="refreshBtn" onclick="newGradient()">
                    <svg width="22" height="18" viewBox="0 0 18 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M15.5372 8.68694C15.6405 8.2858 15.399 7.87692 14.9979 7.77367C14.5967 7.67043 14.1878 7.91192 14.0846 8.31306L15.5372 8.68694ZM14.8109 5.5L14.5014 6.18316C14.8556 6.34362 15.2737 6.20679 15.4644 5.86796L14.8109 5.5ZM2.46264 5.31306C2.35939 5.7142 2.60088 6.12308 3.00202 6.22633C3.40316 6.32958 3.81205 6.08808 3.91529 5.68695L2.46264 5.31306ZM3.18896 8.5L3.49846 7.81683C3.14427 7.65637 2.72618 7.79322 2.53542 8.13206L3.18896 8.5ZM17.1535 2.86796C17.3568 2.50702 17.2289 2.04968 16.868 1.84647C16.507 1.64325 16.0497 1.7711 15.8465 2.13204L17.1535 2.86796ZM11.8095 3.31684C11.4322 3.14591 10.9878 3.3132 10.8168 3.6905C10.6459 4.06779 10.8132 4.51223 11.1905 4.68316L11.8095 3.31684ZM0.846455 11.1321C0.643248 11.493 0.771119 11.9503 1.13206 12.1535C1.493 12.3568 1.95034 12.2289 2.15355 11.8679L0.846455 11.1321ZM6.19051 10.6832C6.56781 10.8541 7.01224 10.6868 7.18316 10.3095C7.35409 9.93219 7.1868 9.48776 6.80949 9.31684L6.19051 10.6832ZM14.0846 8.31306C13.5017 10.5776 11.4452 12.25 8.99994 12.25V13.75C12.1462 13.75 14.788 11.5981 15.5372 8.68694L14.0846 8.31306ZM8.99994 1.75C11.4452 1.75 13.5017 3.42242 14.0846 5.68695L15.5372 5.31306C14.788 2.4019 12.1462 0.25 8.99994 0.25V1.75ZM3.91529 5.68695C4.49814 3.42242 6.55468 1.75 8.99994 1.75V0.25C5.85368 0.25 3.21192 2.4019 2.46264 5.31306L3.91529 5.68695ZM8.99994 12.25C6.55468 12.25 4.49814 10.5776 3.91529 8.31305L2.46264 8.68694C3.21192 11.5981 5.85368 13.75 8.99994 13.75V12.25ZM15.4644 5.86796L17.1535 2.86796L15.8465 2.13204L14.1574 5.13204L15.4644 5.86796ZM15.1204 4.81684L11.8095 3.31684L11.1905 4.68316L14.5014 6.18316L15.1204 4.81684ZM2.53542 8.13206L0.846455 11.1321L2.15355 11.8679L3.84251 8.86794L2.53542 8.13206ZM2.87947 9.18316L6.19051 10.6832L6.80949 9.31684L3.49846 7.81683L2.87947 9.18316Z" fill="white"/>
                    </svg>
                    
                </button>
            </div>

            
        </div>
        <div id="slidersContainer">
            <div class="sliderContainer">
                <label for="LengthSlider">GRADIENT LENGTH</label>
                <div class="slider">
                    <input inputmode="numeric" oninput="this.value = this.value.replace(/\D+/g, '')" id="LengthInput" class="sliderInput" min="2" max="50" value="14">
                    <input type="range" id="LengthSlider" min="2" max="50" value="14" step="1" onchange="newGradient()">
                </div>
            </div>
            <div class="sliderContainer">
                <label for="randomnessSlider">RANDOMNESS</label>
                <div class="slider">
                    <input inputmode="numeric" id="randomnessInput" class="sliderInput" min="0" max="100" value="30%"> <!-- Displayed as percent -->
                    <input type="range" id="randomnessSlider" min="0" max="1" value="0.30" step="0.01" onchange="newGradient()">
                </div>
            </div>    
        </div>
    </div>
  </div>
</div>

<div id="modal" class="blockSelectionModal">
    <div class="modalHeader" id="modalHeader">
        <input type="text" id="searchBar" class="searchBar" placeholder="Search blocks..." oninput="filterBlocks()">
        <button class="closeBtn" onclick="closeModal()">
            <svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                <path d="M4 4 L16 16 M16 4 L4 16" stroke="rgb(150, 100, 160)" stroke-width="2.5" fill="none" stroke-linecap="round"/>
            </svg>
        </button>
    </div>
    <div id="gridContainer"></div>
</div>
<div id="overlay" class="overlay"></div>
<div id="loadingOverlay" class="overlay">loading...</div>

<!-- Block Modal -->
<div id="blockInfoModal" class="blockModal">
    <img id="modalBlockImage" src="" alt="Block Image">
    <div class="blockModalContent">
      <button class="closeBtn closeInfoBtn" onclick="closeBlockModal()">
        <svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
            <path d="M4 4 L16 16 M16 4 L4 16" stroke="rgb(150, 100, 160)" stroke-width="2.5" fill="none" stroke-linecap="round"/>
        </svg>
      </button>
      <div id="modalBlockName"></div>
      <button id="hideBlockButton" onclick="hideBlock()">Exclude Block</button>
    </div>
  </div>
  <div id="blockModalOverlay" class="overlay" onclick="closeBlockModal()"></div>
  

<script>


function rgbToLab(r, g, b) {
function rgbToXyz(r, g, b) {
    r = r / 255;
    g = g / 255;
    b = b / 255;

    r = r > 0.04045 ? Math.pow((r + 0.055) / 1.055, 2.4) : r / 12.92;
    g = g > 0.04045 ? Math.pow((g + 0.055) / 1.055, 2.4) : g / 12.92;
    b = b > 0.04045 ? Math.pow((b + 0.055) / 1.055, 2.4) : b / 12.92;

    let x = r * 0.4124564 + g * 0.3575761 + b * 0.1804375;
    let y = r * 0.2126729 + g * 0.7151522 + b * 0.0721750;
    let z = r * 0.0193339 + g * 0.1191920 + b * 0.9503041;

    x = x * 100;
    y = y * 100; 
    z = z * 100;

    return [x, y, z];
}

function xyzToLab(x, y, z) {
    let refX = 95.047;
    let refY = 100.000;
    let refZ = 108.883;

    x = x / refX;
    y = y / refY;
    z = z / refZ;

    x = x > 0.008856 ? Math.pow(x, 1 / 3) : (7.787 * x) + (16 / 116);
    y = y > 0.008856 ? Math.pow(y, 1 / 3) : (7.787 * y) + (16 / 116);
    z = z > 0.008856 ? Math.pow(z, 1 / 3) : (7.787 * z) + (16 / 116);

    let l = (116 * y) - 16;
    let a = 500 * (x - y);
    let bLab = 200 * (y - z); // Changed variable name to avoid conflict

    return [l, a, bLab];
}

const [x, y, z] = rgbToXyz(r, g, b);
const [l, a, bLab] = xyzToLab(x, y, z); // Use the changed variable name

return [l, a, bLab];
}


function labToRgb(l, a, b) {
      function labToXyz(l, a, b) {
        let y = (l + 16) / 116;
        let x = a / 500 + y;
        let z = y - b / 200;

        let y3 = Math.pow(y, 3);
        let x3 = Math.pow(x, 3);
        let z3 = Math.pow(z, 3);

        y = y3 > 0.008856 ? y3 : (y - 16 / 116) / 7.787;
        x = x3 > 0.008856 ? x3 : (x - 16 / 116) / 7.787;
        z = z3 > 0.008856 ? z3 : (z - 16 / 116) / 7.787;

        x *= 95.047;
        y *= 100.000;
        z *= 108.883;

        return [x, y, z];
      }

      function xyzToRgb(x, y, z) {
        x = x / 100;
        y = y / 100;
        z = z / 100;

        let r = x * 3.2406 + y * -1.5372 + z * -0.4986;
        let g = x * -0.9689 + y * 1.8758 + z * 0.0415;
        let b = x * 0.0557 + y * -0.2040 + z * 1.0570;

        r = r > 0.0031308 ? 1.055 * Math.pow(r, 1 / 2.4) - 0.055 : 12.92 * r;
        g = g > 0.0031308 ? 1.055 * Math.pow(g, 1 / 2.4) - 0.055 : 12.92 * g;
        b = b > 0.0031308 ? 1.055 * Math.pow(b, 1 / 2.4) - 0.055 : 12.92 * b;

        r = Math.min(Math.max(0, r), 1) * 255;
        g = Math.min(Math.max(0, g), 1) * 255;
        b = Math.min(Math.max(0, b), 1) * 255;

        return [Math.round(r), Math.round(g), Math.round(b)];
      }

      const [x, y, z] = labToXyz(l, a, b);
      return xyzToRgb(x, y, z);
    }


function deltaE(labA, labB) {
var deltaL = labA[0] - labB[0];
var deltaA = labA[1] - labB[1];
var deltaB = labA[2] - labB[2];
var c1 = Math.sqrt(labA[1] * labA[1] + labA[2] * labA[2]);
var c2 = Math.sqrt(labB[1] * labB[1] + labB[2] * labB[2]);
var deltaC = c1 - c2;
var deltaH = deltaA * deltaA + deltaB * deltaB - deltaC * deltaC;
deltaH = deltaH < 0 ? 0 : Math.sqrt(deltaH);
var sc = 1.0 + 0.045 * c1;
var sh = 1.0 + 0.015 * c1;
var deltaLKlsl = deltaL / (1.0);
var deltaCkcsc = deltaC / (sc);
var deltaHkhsh = deltaH / (sh);
var i = deltaLKlsl * deltaLKlsl + deltaCkcsc * deltaCkcsc + deltaHkhsh * deltaHkhsh;
return i < 0 ? 0 : Math.sqrt(i);
}

function rgbSimilarity(rgb1, rgb2) {
const lab1 = rgbToLab(rgb1[0], rgb1[1], rgb1[2]);
const lab2 = rgbToLab(rgb2[0], rgb2[1], rgb2[2]);
const deltaEValue = deltaE(lab1, lab2);
return deltaEValue;
}

function calculateSimilarity(rgb1, rgb2) {

// Calculate similarity
const similarity = rgbSimilarity(rgb1, rgb2);

return similarity;
}



function findClosestColorIndex(targetColor, colorArray) {
    // Initialize variables to keep track of the minimum similarity and index
    let minSimilarity = Infinity;
    let closestIndex = -1;

    // Loop through each color in the array
    for (let i = 0; i < colorArray.length; i++) {
        // Calculate the similarity between the target color and the current color
        if (!hiddenBlocks.includes(i)) {
            const similarity = calculateSimilarity(targetColor, colorArray[i][2]);

            // Check if this similarity is the smallest we've found so far
            if (similarity < minSimilarity) {
                minSimilarity = similarity;  // Update the minimum similarity
                closestIndex = i;            // Update the index of the closest color
            }
        }

    }

    // Return the index of the closest color
    return closestIndex;
}

function interpolateColors(rgb1, rgb2, percentage) {
      const [l1, a1, b1] = rgbToLab(rgb1[0], rgb1[1], rgb1[2]);
      const [l2, a2, b2] = rgbToLab(rgb2[0], rgb2[1], rgb2[2]);

      const l = l1 + (l2 - l1) * percentage;
      const a = a1 + (a2 - a1) * percentage;
      const b = b1 + (b2 - b1) * percentage;

      return labToRgb(l, a, b);
    }


// Example usage

const colorArray = [
  ["bedrock","textures/blocks/bedrock.png",[85,85,85]],["blast furnace front off","textures/blocks/blast_furnace_front_off.png",[107,107,107]],["blast furnace side","textures/blocks/blast_furnace_side.png",[107,107,107]],["coal block","textures/blocks/coal_block.png",[16,15,15]],["coal ore","textures/blocks/coal_ore.png",[105,105,105]],["cobblestone","textures/blocks/cobblestone.png",[127,127,127]],["concrete red","textures/blocks/concrete_red.png",[142,32,32]],["crimson nylium side","textures/blocks/crimson_nylium_side.png",[107,26,26]],["crimson nylium top","textures/blocks/crimson_nylium_top.png",[130,31,31]],["dispenser front horizontal","textures/blocks/dispenser_front_horizontal.png",[122,121,121]],["dispenser front vertical","textures/blocks/dispenser_front_vertical.png",[98,97,97]],["dropper front horizontal","textures/blocks/dropper_front_horizontal.png",[122,121,121]],["dropper front vertical","textures/blocks/dropper_front_vertical.png",[97,96,96]],["furnace front off","textures/blocks/furnace_front_off.png",[91,91,91]],["furnace side","textures/blocks/furnace_side.png",[120,120,120]],["furnace top","textures/blocks/furnace_top.png",[110,109,109]],["hardened clay stained pink","textures/blocks/hardened_clay_stained_pink.png",[161,78,78]],["iron block","textures/blocks/iron_block.png",[220,220,220]],["netherrack","textures/blocks/netherrack.png",[97,38,38]],["observer back","textures/blocks/observer_back.png",[71,69,69]],["observer front","textures/blocks/observer_front.png",[103,103,103]],["observer side","textures/blocks/observer_side.png",[70,68,68]],["observer top","textures/blocks/observer_top.png",[98,98,98]],["piston bottom","textures/blocks/piston_bottom.png",[97,96,96]],["redstone ore","textures/blocks/redstone_ore.png",[140,109,109]],["smithing table side","textures/blocks/smithing_table_side.png",[55,35,35]],["stone","textures/blocks/stone.png",[125,125,125]],["stone andesite","textures/blocks/stone_andesite.png",[136,136,136]],["stone diorite","textures/blocks/stone_diorite.png",[188,188,188]],["stone slab side","textures/blocks/stone_slab_side.png",[167,167,167]],["stone slab top","textures/blocks/stone_slab_top.png",[158,158,158]],["stonecutter bottom","textures/blocks/stonecutter_bottom.png",[96,96,96]],["stonecutter other side","textures/blocks/stonecutter_other_side.png",[113,113,113]],["stripped mangrove log top","textures/blocks/stripped_mangrove_log_top.png",[109,43,43]],["chiseled deepslate","textures/blocks/deepslate/chiseled_deepslate.png",[54,54,54]],["cracked deepslate tiles","textures/blocks/deepslate/cracked_deepslate_tiles.png",[52,52,52]],["mushroom block skin red","textures/blocks/mushroom_block_skin_red.png",[200,46,45]],["nether wart block","textures/blocks/nether_wart_block.png",[114,3,2]],["shulker top red","textures/blocks/shulker_top_red.png",[140,31,30]],["concrete powder red","textures/blocks/concrete_powder_red.png",[168,54,50]],["wool colored red","textures/blocks/wool_colored_red.png",[160,39,34]],["tnt side","textures/blocks/tnt_side.png",[182,88,84]],["glazed terracotta red","textures/blocks/glazed_terracotta_red.png",[181,59,53]],["quartz ore","textures/blocks/quartz_ore.png",[117,65,62]],["cherry log top","textures/blocks/cherry_log_top.png",[185,141,137]],["mangrove planks","textures/blocks/mangrove_planks.png",[117,54,48]],["stripped mangrove log side","textures/blocks/stripped_mangrove_log_side.png",[119,54,47]],["mangrove log top","textures/blocks/mangrove_log_top.png",[102,48,42]],["tnt top","textures/blocks/tnt_top.png",[142,62,53]],["stripped cherry log top","textures/blocks/stripped_cherry_log_top.png",[221,164,157]],["cherry planks","textures/blocks/cherry_planks.png",[226,178,172]],["redstone block","textures/blocks/redstone_block.png",[175,24,5]],["tnt bottom","textures/blocks/tnt_bottom.png",[166,66,53]],["smithing table bottom","textures/blocks/smithing_table_bottom.png",[64,28,23]],["target side","textures/blocks/target_side.png",[229,176,168]],["warped nylium side","textures/blocks/warped_nylium_side.png",[72,61,59]],["hardened clay stained red","textures/blocks/hardened_clay_stained_red.png",[143,61,46]],["nether gold ore","textures/blocks/nether_gold_ore.png",[115,54,42]],["pearlescent froglight top","textures/blocks/pearlescent_froglight_top.png",[245,240,239]],["target top","textures/blocks/target_top.png",[226,170,157]],["suspicious gravel 0","textures/blocks/suspicious_gravel_0.png",[129,125,124]],["ancient debris side","textures/blocks/ancient_debris_side.png",[95,63,55]],["gravel","textures/blocks/gravel.png",[131,127,126]],["brick","textures/blocks/brick.png",[150,97,83]],["ancient debris top","textures/blocks/ancient_debris_top.png",[94,66,58]],["cut copper","textures/blocks/cut_copper.png",[191,106,80]],["gilded blackstone","textures/blocks/gilded_blackstone.png",[55,42,38]],["hardened clay stained silver","textures/blocks/hardened_clay_stained_silver.png",[135,106,97]],["copper block","textures/blocks/copper_block.png",[192,107,79]],["stone granite smooth","textures/blocks/stone_granite_smooth.png",[154,106,89]],["stone granite","textures/blocks/stone_granite.png",[149,103,85]],["hardened clay stained black","textures/blocks/hardened_clay_stained_black.png",[37,22,16]],["stripped acacia log","textures/blocks/stripped_acacia_log.png",[174,92,59]],["coral pink dead","textures/blocks/coral_pink_dead.png",[124,117,114]],["hardened clay","textures/blocks/hardened_clay.png",[152,94,67]],["hardened clay stained gray","textures/blocks/hardened_clay_stained_gray.png",[57,42,35]],["coral purple dead","textures/blocks/coral_purple_dead.png",[131,123,119]],["coral red dead","textures/blocks/coral_red_dead.png",[131,123,119]],["planks acacia","textures/blocks/planks_acacia.png",[168,90,50]],["raw copper block","textures/blocks/raw_copper_block.png",[154,105,79]],["log acacia top","textures/blocks/log_acacia_top.png",[150,88,55]],["stripped acacia log top","textures/blocks/stripped_acacia_log_top.png",[166,91,51]],["hardened clay stained white","textures/blocks/hardened_clay_stained_white.png",[209,178,161]],["command block side mipmap","textures/blocks/command_block_side_mipmap.png",[167,129,108]],["command block back mipmap","textures/blocks/command_block_back_mipmap.png",[163,127,107]],["dripstone block","textures/blocks/dripstone_block.png",[134,107,92]],["command block conditional mipmap","textures/blocks/command_block_conditional_mipmap.png",[168,129,107]],["coral yellow dead","textures/blocks/coral_yellow_dead.png",[133,126,122]],["coral blue dead","textures/blocks/coral_blue_dead.png",[130,123,119]],["redstone lamp off","textures/blocks/redstone_lamp_off.png",[95,54,30]],["jukebox top","textures/blocks/jukebox_top.png",[93,64,47]],["hardened clay stained orange","textures/blocks/hardened_clay_stained_orange.png",[161,83,37]],["jukebox side","textures/blocks/jukebox_side.png",[88,58,40]],["noteblock","textures/blocks/noteblock.png",[88,58,40]],["command block front mipmap","textures/blocks/command_block_front_mipmap.png",[172,132,108]],["exposed cut copper","textures/blocks/exposed_cut_copper.png",[154,121,101]],["exposed copper","textures/blocks/exposed_copper.png",[161,125,103]],["soul soil","textures/blocks/soul_soil.png",[75,57,46]],["hardened clay stained brown","textures/blocks/hardened_clay_stained_brown.png",[77,51,35]],["mycelium side","textures/blocks/mycelium_side.png",[113,87,71]],["soul sand","textures/blocks/soul_sand.png",[81,62,50]],["dirt with roots","textures/blocks/dirt_with_roots.png",[144,103,76]],["loom side","textures/blocks/loom_side.png",[145,101,72]],["crafting table top","textures/blocks/crafting_table_top.png",[119,73,42]],["mud bricks","textures/blocks/mud_bricks.png",[137,103,79]],["deepslate iron ore","textures/blocks/deepslate/deepslate_iron_ore.png",[106,99,94]],["wool colored brown","textures/blocks/wool_colored_brown.png",[114,71,40]],["packed mud","textures/blocks/packed_mud.png",[142,106,79]],["concrete powder brown","textures/blocks/concrete_powder_brown.png",[125,84,53]],["concrete brown","textures/blocks/concrete_brown.png",[96,59,31]],["dirt","textures/blocks/dirt.png",[134,96,67]],["concrete orange","textures/blocks/concrete_orange.png",[224,97,0]],["coarse dirt","textures/blocks/coarse_dirt.png",[119,85,59]],["shulker top orange","textures/blocks/shulker_top_orange.png",[234,106,8]],["shulker top brown","textures/blocks/shulker_top_brown.png",[106,66,35]],["planks jungle","textures/blocks/planks_jungle.png",[160,115,80]],["red sand","textures/blocks/red_sand.png",[190,102,33]],["red sandstone top","textures/blocks/red_sandstone_top.png",[181,97,31]],["mushroom block skin brown","textures/blocks/mushroom_block_skin_brown.png",[149,111,81]],["red sandstone carved","textures/blocks/red_sandstone_carved.png",[183,96,27]],["red sandstone smooth","textures/blocks/red_sandstone_smooth.png",[189,101,31]],["red sandstone bottom","textures/blocks/red_sandstone_bottom.png",[185,98,28]],["red sandstone normal","textures/blocks/red_sandstone_normal.png",[186,99,29]],["shroomlight","textures/blocks/shroomlight.png",[240,146,70]],["wool colored orange","textures/blocks/wool_colored_orange.png",[240,118,19]],["dirt podzol side","textures/blocks/dirt_podzol_side.png",[122,87,57]],["raw iron block","textures/blocks/raw_iron_block.png",[166,135,107]],["chiseled bookshelf occupied","textures/blocks/chiseled_bookshelf_occupied.png",[121,94,69]],["composter side","textures/blocks/composter_side.png",[112,70,31]],["cartography table side2","textures/blocks/cartography_table_side2.png",[81,61,42]],["stripped jungle log top","textures/blocks/stripped_jungle_log_top.png",[165,122,81]],["cartography table side3","textures/blocks/cartography_table_side3.png",[67,43,20]],["log jungle top","textures/blocks/log_jungle_top.png",[149,109,70]],["smoker bottom","textures/blocks/smoker_bottom.png",[107,105,103]],["iron ore","textures/blocks/iron_ore.png",[136,129,122]],["redstone lamp on","textures/blocks/redstone_lamp_on.png",[142,101,60]],["muddy mangrove roots side","textures/blocks/muddy_mangrove_roots_side.png",[68,58,48]],["planks big oak","textures/blocks/planks_big_oak.png",[66,43,20]],["log spruce","textures/blocks/log_spruce.png",[58,37,16]],["smoker top","textures/blocks/smoker_top.png",[85,83,81]],["pumpkin face off","textures/blocks/pumpkin_face_off.png",[150,84,17]],["concrete powder orange","textures/blocks/concrete_powder_orange.png",[227,131,31]],["log big oak top","textures/blocks/log_big_oak_top.png",[67,45,22]],["stripped dark oak log top","textures/blocks/stripped_dark_oak_log_top.png",[65,44,22]],["muddy mangrove roots top","textures/blocks/muddy_mangrove_roots_top.png",[70,58,45]],["pumpkin side","textures/blocks/pumpkin_side.png",[195,114,24]],["quartz block bottom","textures/blocks/quartz_block_bottom.png",[236,230,223]],["quartz block lines top","textures/blocks/quartz_block_lines_top.png",[235,229,222]],["quartz block side","textures/blocks/quartz_block_side.png",[235,229,222]],["quartz block top","textures/blocks/quartz_block_top.png",[235,229,222]],["glowstone","textures/blocks/glowstone.png",[171,131,84]],["pumpkin top","textures/blocks/pumpkin_top.png",[198,118,24]],["barrel side","textures/blocks/barrel_side.png",[107,81,50]],["loom front","textures/blocks/loom_front.png",[148,118,82]],["planks spruce","textures/blocks/planks_spruce.png",[114,84,48]],["quartz block lines","textures/blocks/quartz_block_lines.png",[235,230,224]],["bee nest bottom","textures/blocks/bee_nest_bottom.png",[160,127,87]],["log spruce top","textures/blocks/log_spruce_top.png",[108,80,46]],["loom top","textures/blocks/loom_top.png",[142,119,91]],["stripped jungle log","textures/blocks/stripped_jungle_log.png",[171,132,84]],["barrel bottom","textures/blocks/barrel_bottom.png",[115,85,48]],["barrel top","textures/blocks/barrel_top.png",[134,100,58]],["cartography table top","textures/blocks/cartography_table_top.png",[103,87,67]],["stripped dark oak log","textures/blocks/stripped_dark_oak_log.png",[72,56,36]],["piston side","textures/blocks/piston_side.png",[110,104,96]],["stripped spruce log top","textures/blocks/stripped_spruce_log_top.png",[105,80,46]],["stripped spruce log","textures/blocks/stripped_spruce_log.png",[79,60,34]],["dirt podzol top","textures/blocks/dirt_podzol_top.png",[91,63,24]],["log acacia","textures/blocks/log_acacia.png",[103,96,86]],["log big oak","textures/blocks/log_big_oak.png",[60,46,26]],["chiseled bookshelf empty","textures/blocks/chiseled_bookshelf_empty.png",[90,70,41]],["smoker side","textures/blocks/smoker_side.png",[102,91,75]],["crafting table front","textures/blocks/crafting_table_front.png",[129,105,70]],["log oak","textures/blocks/log_oak.png",[109,85,50]],["honeycomb","textures/blocks/honeycomb.png",[229,148,29]],["mangrove log side","textures/blocks/mangrove_log_side.png",[83,66,41]],["piston top normal","textures/blocks/piston_top_normal.png",[154,127,87]],["loom bottom","textures/blocks/loom_bottom.png",[76,60,36]],["smoker front off","textures/blocks/smoker_front_off.png",[87,75,57]],["bookshelf","textures/blocks/bookshelf.png",[117,94,59]],["bee nest front","textures/blocks/bee_nest_front.png",[183,141,76]],["beehive top","textures/blocks/beehive_top.png",[179,144,89]],["mushroom block skin stem","textures/blocks/mushroom_block_skin_stem.png",[203,196,185]],["beehive front honey","textures/blocks/beehive_front_honey.png",[165,129,72]],["bee nest side","textures/blocks/bee_nest_side.png",[196,150,77]],["quartz block chiseled","textures/blocks/quartz_block_chiseled.png",[231,226,218]],["log oak top","textures/blocks/log_oak_top.png",[151,121,73]],["quartz bricks","textures/blocks/quartz_bricks.png",[234,229,221]],["beehive front","textures/blocks/beehive_front.png",[156,125,75]],["mushroom block inside","textures/blocks/mushroom_block_inside.png",[201,170,120]],["pumpkin face on","textures/blocks/pumpkin_face_on.png",[214,152,52]],["glazed terracotta brown","textures/blocks/glazed_terracotta_brown.png",[119,106,85]],["chiseled bookshelf side","textures/blocks/chiseled_bookshelf_side.png",[175,141,86]],["planks oak","textures/blocks/planks_oak.png",[162,130,78]],["beehive side","textures/blocks/beehive_side.png",[157,126,75]],["chiseled bookshelf top","textures/blocks/chiseled_bookshelf_top.png",[178,144,88]],["stripped oak log top","textures/blocks/stripped_oak_log_top.png",[160,129,77]],["stripped oak log","textures/blocks/stripped_oak_log.png",[177,144,86]],["bee nest front honey","textures/blocks/bee_nest_front_honey.png",[194,151,75]],["quartz block chiseled top","textures/blocks/quartz_block_chiseled_top.png",[231,226,217]],["deepslate gold ore","textures/blocks/deepslate/deepslate_gold_ore.png",[115,102,78]],["hardened clay stained yellow","textures/blocks/hardened_clay_stained_yellow.png",[186,133,35]],["bee nest top","textures/blocks/bee_nest_top.png",[202,160,74]],["gold ore","textures/blocks/gold_ore.png",[145,133,106]],["log jungle","textures/blocks/log_jungle.png",[85,67,25]],["raw gold block","textures/blocks/raw_gold_block.png",[221,169,46]],["concrete yellow","textures/blocks/concrete_yellow.png",[240,175,21]],["fletcher table side2","textures/blocks/fletcher_table_side2.png",[173,155,111]],["glazed terracotta yellow","textures/blocks/glazed_terracotta_yellow.png",[234,192,88]],["shulker top yellow","textures/blocks/shulker_top_yellow.png",[248,188,29]],["stripped birch log top","textures/blocks/stripped_birch_log_top.png",[191,171,116]],["fletcher table top","textures/blocks/fletcher_table_top.png",[197,180,133]],["stripped birch log","textures/blocks/stripped_birch_log.png",[196,176,118]],["wool colored yellow","textures/blocks/wool_colored_yellow.png",[248,197,39]],["log birch top","textures/blocks/log_birch_top.png",[193,179,135]],["planks birch","textures/blocks/planks_birch.png",[192,175,121]],["hay block side","textures/blocks/hay_block_side.png",[166,136,38]],["sandstone carved","textures/blocks/sandstone_carved.png",[216,202,155]],["suspicious sand 0","textures/blocks/suspicious_sand_0.png",[217,204,159]],["sand","textures/blocks/sand.png",[219,207,163]],["sandstone bottom","textures/blocks/sandstone_bottom.png",[215,202,154]],["sandstone normal","textures/blocks/sandstone_normal.png",[216,203,155]],["gold block","textures/blocks/gold_block.png",[246,208,61]],["sandstone smooth","textures/blocks/sandstone_smooth.png",[217,206,159]],["stripped bamboo block top","textures/blocks/stripped_bamboo_block_top.png",[178,158,72]],["ochre froglight side","textures/blocks/ochre_froglight_side.png",[245,233,181]],["concrete powder yellow","textures/blocks/concrete_powder_yellow.png",[232,199,54]],["bone block side","textures/blocks/bone_block_side.png",[229,225,207]],["bamboo mosaic","textures/blocks/bamboo_mosaic.png",[190,170,78]],["bamboo planks","textures/blocks/bamboo_planks.png",[193,173,80]],["stripped bamboo block","textures/blocks/stripped_bamboo_block.png",[193,173,80]],["hay block top","textures/blocks/hay_block_top.png",[165,139,12]],["sandstone top","textures/blocks/sandstone_top.png",[223,214,170]],["log birch","textures/blocks/log_birch.png",[216,215,210]],["ochre froglight top","textures/blocks/ochre_froglight_top.png",[250,245,206]],["coral yellow","textures/blocks/coral_yellow.png",[216,199,66]],["glazed terracotta orange","textures/blocks/glazed_terracotta_orange.png",[154,147,91]],["bone block top","textures/blocks/bone_block_top.png",[209,206,179]],["sponge","textures/blocks/sponge.png",[195,192,74]],["concrete powder silver","textures/blocks/concrete_powder_silver.png",[154,154,148]],["concrete silver","textures/blocks/concrete_silver.png",[125,125,115]],["shulker top silver","textures/blocks/shulker_top_silver.png",[124,124,115]],["wool colored silver","textures/blocks/wool_colored_silver.png",[142,142,134]],["bamboo block top","textures/blocks/bamboo_block_top.png",[139,141,62]],["end stone","textures/blocks/end_stone.png",[219,222,158]],["sponge wet","textures/blocks/sponge_wet.png",[171,181,70]],["end bricks","textures/blocks/end_bricks.png",[218,224,162]],["tuff","textures/blocks/tuff.png",[108,109,102]],["hardened clay stained green","textures/blocks/hardened_clay_stained_green.png",[76,83,42]],["bamboo block","textures/blocks/bamboo_block.png",[127,144,57]],["copper ore","textures/blocks/copper_ore.png",[124,125,120]],["hardened clay stained lime","textures/blocks/hardened_clay_stained_lime.png",[103,117,52]],["glazed terracotta lime","textures/blocks/glazed_terracotta_lime.png",[162,197,55]],["deepslate copper ore","textures/blocks/deepslate/deepslate_copper_ore.png",[92,93,89]],["calcite","textures/blocks/calcite.png",[223,224,220]],["melon side","textures/blocks/melon_side.png",[114,146,30]],["melon top","textures/blocks/melon_top.png",[111,144,30]],["concrete powder green","textures/blocks/concrete_powder_green.png",[97,119,44]],["shulker top green","textures/blocks/shulker_top_green.png",[79,100,31]],["wool colored green","textures/blocks/wool_colored_green.png",[84,109,27]],["moss block","textures/blocks/moss_block.png",[89,109,45]],["concrete green","textures/blocks/concrete_green.png",[73,91,36]],["cobblestone mossy","textures/blocks/cobblestone_mossy.png",[110,118,94]],["glazed terracotta green","textures/blocks/glazed_terracotta_green.png",[117,142,67]],["stonebrick mossy","textures/blocks/stonebrick_mossy.png",[115,121,105]],["dried kelp top","textures/blocks/dried_kelp_top.png",[50,58,38]],["concrete powder lime","textures/blocks/concrete_powder_lime.png",[125,189,41]],["wool colored lime","textures/blocks/wool_colored_lime.png",[112,185,25]],["piston top sticky","textures/blocks/piston_top_sticky.png",[122,149,92]],["shulker top lime","textures/blocks/shulker_top_lime.png",[99,172,23]],["reinforced deepslate top","textures/blocks/reinforced_deepslate_top.png",[80,82,78]],["concrete lime","textures/blocks/concrete_lime.png",[94,168,24]],["dried kelp side a","textures/blocks/dried_kelp_side_a.png",[38,48,29]],["dried kelp side b","textures/blocks/dried_kelp_side_b.png",[38,48,29]],["reinforced deepslate side","textures/blocks/reinforced_deepslate_side.png",[102,109,100]],["verdant froglight side","textures/blocks/verdant_froglight_side.png",[211,234,208]],["verdant froglight top","textures/blocks/verdant_froglight_top.png",[229,244,228]],["weathered cut copper","textures/blocks/weathered_cut_copper.png",[109,145,107]],["reinforced deepslate bottom","textures/blocks/reinforced_deepslate_bottom.png",[79,82,79]],["weathered copper","textures/blocks/weathered_copper.png",[108,153,110]],["emerald ore","textures/blocks/emerald_ore.png",[108,136,115]],["emerald block","textures/blocks/emerald_block.png",[42,203,87]],["deepslate emerald ore","textures/blocks/deepslate/deepslate_emerald_ore.png",[78,104,87]],["stone andesite smooth","textures/blocks/stone_andesite_smooth.png",[132,134,133]],["chain command block front mipmap","textures/blocks/chain_command_block_front_mipmap.png",[129,159,146]],["chain command block conditional mipmap","textures/blocks/chain_command_block_conditional_mipmap.png",[127,155,143]],["chain command block side mipmap","textures/blocks/chain_command_block_side_mipmap.png",[128,154,143]],["glazed terracotta white","textures/blocks/glazed_terracotta_white.png",[188,212,202]],["chain command block back mipmap","textures/blocks/chain_command_block_back_mipmap.png",[126,150,140]],["prismarine dark","textures/blocks/prismarine_dark.png",[51,91,75]],["oxidized copper","textures/blocks/oxidized_copper.png",[82,162,132]],["oxidized cut copper","textures/blocks/oxidized_cut_copper.png",[79,153,126]],["warped nylium top","textures/blocks/warped_nylium_top.png",[43,114,101]],["prismarine bricks","textures/blocks/prismarine_bricks.png",[99,171,158]],["sculk catalyst side","textures/blocks/sculk_catalyst_side.png",[76,93,90]],["warped planks","textures/blocks/huge_fungus/warped_planks.png",[43,104,99]],["diamond block","textures/blocks/diamond_block.png",[98,237,228]],["stripped warped stem top","textures/blocks/huge_fungus/stripped_warped_stem_top.png",[52,128,124]],["diamond ore","textures/blocks/diamond_ore.png",[121,141,140]],["stripped warped stem side","textures/blocks/huge_fungus/stripped_warped_stem_side.png",[57,150,147]],["concrete powder white","textures/blocks/concrete_powder_white.png",[225,227,227]],["hardened clay stained cyan","textures/blocks/hardened_clay_stained_cyan.png",[86,91,91]],["powder snow","textures/blocks/powder_snow.png",[248,253,253]],["snow","textures/blocks/snow.png",[249,254,254]],["wool colored white","textures/blocks/wool_colored_white.png",[233,236,236]],["deepslate diamond ore","textures/blocks/deepslate/deepslate_diamond_ore.png",[83,106,106]],["warped stem top","textures/blocks/huge_fungus/warped_stem_top.png",[53,109,110]],["warped wart block","textures/blocks/warped_wart_block.png",[22,119,121]],["glazed terracotta silver","textures/blocks/glazed_terracotta_silver.png",[144,166,167]],["wool colored cyan","textures/blocks/wool_colored_cyan.png",[21,137,145]],["concrete powder cyan","textures/blocks/concrete_powder_cyan.png",[36,147,157]],["glazed terracotta cyan","textures/blocks/glazed_terracotta_cyan.png",[52,118,125]],["shulker top cyan","textures/blocks/shulker_top_cyan.png",[20,121,135]],["concrete white","textures/blocks/concrete_white.png",[207,213,214]],["concrete cyan","textures/blocks/concrete_cyan.png",[21,119,136]],["shulker top white","textures/blocks/shulker_top_white.png",[215,220,221]],["concrete powder light blue","textures/blocks/concrete_powder_light_blue.png",[74,180,213]],["wool colored light blue","textures/blocks/wool_colored_light_blue.png",[58,175,217]],["glazed terracotta gray","textures/blocks/glazed_terracotta_gray.png",[83,90,93]],["sculk sensor bottom","textures/blocks/sculk_sensor_bottom.png",[13,27,33]],["shulker top light blue","textures/blocks/shulker_top_light_blue.png",[49,163,212]],["sculk catalyst top","textures/blocks/sculk_catalyst_top.png",[15,31,38]],["wool colored gray","textures/blocks/wool_colored_gray.png",[62,68,71]],["concrete light blue","textures/blocks/concrete_light_blue.png",[35,137,198]],["concrete powder gray","textures/blocks/concrete_powder_gray.png",[76,81,84]],["glazed terracotta light blue","textures/blocks/glazed_terracotta_light_blue.png",[94,164,208]],["stone diorite smooth","textures/blocks/stone_diorite_smooth.png",[192,193,194]],["concrete gray","textures/blocks/concrete_gray.png",[54,57,61]],["shulker top gray","textures/blocks/shulker_top_gray.png",[55,58,62]],["lodestone top","textures/blocks/lodestone_top.png",[147,149,152]],["blue ice","textures/blocks/blue_ice.png",[116,167,253]],["ice packed","textures/blocks/ice_packed.png",[141,180,250]],["lapis block","textures/blocks/lapis_block.png",[30,67,140]],["clay","textures/blocks/clay.png",[160,166,179]],["deepslate lapis ore","textures/blocks/deepslate/deepslate_lapis_ore.png",[79,90,115]],["lapis ore","textures/blocks/lapis_ore.png",[107,117,141]],["concrete black","textures/blocks/concrete_black.png",[8,10,15]],["coral blue","textures/blocks/coral_blue.png",[49,87,206]],["wool colored black","textures/blocks/wool_colored_black.png",[20,21,25]],["glazed terracotta blue","textures/blocks/glazed_terracotta_blue.png",[47,64,139]],["basalt top","textures/blocks/basalt_top.png",[80,81,86]],["concrete powder black","textures/blocks/concrete_powder_black.png",[25,26,31]],["smithing table top","textures/blocks/smithing_table_top.png",[57,58,70]],["wool colored blue","textures/blocks/wool_colored_blue.png",[53,57,157]],["concrete powder blue","textures/blocks/concrete_powder_blue.png",[70,73,166]],["shulker top blue","textures/blocks/shulker_top_blue.png",[43,45,140]],["concrete blue","textures/blocks/concrete_blue.png",[44,46,143]],["blast furnace top","textures/blocks/blast_furnace_top.png",[80,80,81]],["lodestone side","textures/blocks/lodestone_side.png",[119,119,123]],["polished basalt side","textures/blocks/polished_basalt_side.png",[88,88,91]],["shulker top black","textures/blocks/shulker_top_black.png",[25,25,29]],["smooth basalt","textures/blocks/smooth_basalt.png",[72,72,78]],["cobbled deepslate","textures/blocks/deepslate/cobbled_deepslate.png",[77,77,80]],["cracked deepslate bricks","textures/blocks/deepslate/cracked_deepslate_bricks.png",[64,64,65]],["deepslate","textures/blocks/deepslate/deepslate.png",[80,80,82]],["deepslate bricks","textures/blocks/deepslate/deepslate_bricks.png",[70,70,71]],["deepslate coal ore","textures/blocks/deepslate/deepslate_coal_ore.png",[74,74,76]],["deepslate tiles","textures/blocks/deepslate/deepslate_tiles.png",[54,54,55]],["deepslate top","textures/blocks/deepslate/deepslate_top.png",[87,87,89]],["polished deepslate","textures/blocks/deepslate/polished_deepslate.png",[72,72,73]],["hardened clay stained light blue","textures/blocks/hardened_clay_stained_light_blue.png",[113,108,137]],["basalt side","textures/blocks/basalt_side.png",[73,72,77]],["repeating command block front mipmap","textures/blocks/repeating_command_block_front_mipmap.png",[123,107,171]],["repeating command block conditional mipmap","textures/blocks/repeating_command_block_conditional_mipmap.png",[121,105,168]],["repeating command block side mipmap","textures/blocks/repeating_command_block_side_mipmap.png",[122,106,166]],["repeating command block back mipmap","textures/blocks/repeating_command_block_back_mipmap.png",[121,105,162]],["obsidian","textures/blocks/obsidian.png",[15,10,24]],["amethyst block","textures/blocks/amethyst_block.png",[133,97,191]],["respawn anchor side0","textures/blocks/respawn_anchor_side0.png",[39,23,62]],["crying obsidian","textures/blocks/crying_obsidian.png",[32,10,60]],["respawn anchor bottom","textures/blocks/respawn_anchor_bottom.png",[32,10,60]],["hardened clay stained blue","textures/blocks/hardened_clay_stained_blue.png",[74,59,91]],["polished basalt top","textures/blocks/polished_basalt_top.png",[99,98,100]],["concrete purple","textures/blocks/concrete_purple.png",[100,31,156]],["shulker top purple","textures/blocks/shulker_top_purple.png",[103,32,156]],["glazed terracotta purple","textures/blocks/glazed_terracotta_purple.png",[109,48,152]],["wool colored purple","textures/blocks/wool_colored_purple.png",[121,42,172]],["concrete powder purple","textures/blocks/concrete_powder_purple.png",[131,55,177]],["chiseled polished blackstone","textures/blocks/chiseled_polished_blackstone.png",[53,48,56]],["polished blackstone","textures/blocks/polished_blackstone.png",[53,48,56]],["polished blackstone bricks","textures/blocks/polished_blackstone_bricks.png",[48,42,49]],["structure block","textures/blocks/structure_block.png",[88,74,90]],["jigsaw side","textures/blocks/jigsaw_side.png",[62,53,63]],["structure block corner","textures/blocks/structure_block_corner.png",[68,57,69]],["structure block load","textures/blocks/structure_block_load.png",[69,57,70]],["structure block export","textures/blocks/structure_block_export.png",[70,58,71]],["structure block data","textures/blocks/structure_block_data.png",[79,65,80]],["structure block save","textures/blocks/structure_block_save.png",[86,71,87]],["mud","textures/blocks/mud.png",[60,57,60]],["purpur block","textures/blocks/purpur_block.png",[169,125,169]],["purpur pillar","textures/blocks/purpur_pillar.png",[171,129,171]],["purpur pillar top","textures/blocks/purpur_pillar_top.png",[171,128,171]],["shulker top undyed","textures/blocks/shulker_top_undyed.png",[139,96,139]],["stonebrick","textures/blocks/stonebrick.png",[122,121,122]],["stonebrick carved","textures/blocks/stonebrick_carved.png",[119,118,119]],["stonebrick cracked","textures/blocks/stonebrick_cracked.png",[118,117,118]],["stonecutter2 bottom","textures/blocks/stonecutter2_bottom.png",[118,117,118]],["coral purple","textures/blocks/coral_purple.png",[183,32,180]],["concrete powder magenta","textures/blocks/concrete_powder_magenta.png",[192,83,184]],["concrete magenta","textures/blocks/concrete_magenta.png",[169,48,159]],["wool colored magenta","textures/blocks/wool_colored_magenta.png",[189,68,179]],["shulker top magenta","textures/blocks/shulker_top_magenta.png",[173,54,163]],["cracked polished blackstone bricks","textures/blocks/cracked_polished_blackstone_bricks.png",[44,37,43]],["glazed terracotta magenta","textures/blocks/glazed_terracotta_magenta.png",[208,100,191]],["blackstone top","textures/blocks/blackstone_top.png",[42,36,41]],["blackstone","textures/blocks/blackstone.png",[42,35,40]],["coral pink","textures/blocks/coral_pink.png",[207,91,159]],["cherry log side","textures/blocks/cherry_log_side.png",[54,33,44]],["crimson planks","textures/blocks/huge_fungus/crimson_planks.png",[101,48,70]],["stripped crimson stem side","textures/blocks/huge_fungus/stripped_crimson_stem_side.png",[137,57,90]],["stripped crimson stem top","textures/blocks/huge_fungus/stripped_crimson_stem_top.png",[121,56,82]],["netherite block","textures/blocks/netherite_block.png",[66,61,63]],["concrete powder pink","textures/blocks/concrete_powder_pink.png",[228,153,181]],["concrete pink","textures/blocks/concrete_pink.png",[213,101,142]],["pearlescent froglight side","textures/blocks/pearlescent_froglight_side.png",[235,224,228]],["glazed terracotta pink","textures/blocks/glazed_terracotta_pink.png",[235,154,181]],["hardened clay stained purple","textures/blocks/hardened_clay_stained_purple.png",[118,70,86]],["crimson log top","textures/blocks/huge_fungus/crimson_log_top.png",[112,49,70]],["shulker top pink","textures/blocks/shulker_top_pink.png",[230,121,157]],["hardened clay stained magenta","textures/blocks/hardened_clay_stained_magenta.png",[149,88,108]],["wool colored pink","textures/blocks/wool_colored_pink.png",[237,141,172]],["mycelium top","textures/blocks/mycelium_top.png",[111,98,101]],["nether brick","textures/blocks/nether_brick.png",[44,21,26]],["chiseled nether bricks","textures/blocks/chiseled_nether_bricks.png",[47,23,28]],["cracked nether bricks","textures/blocks/cracked_nether_bricks.png",[40,20,23]],["coral red","textures/blocks/coral_red.png",[162,35,48]],["glazed terracotta black","textures/blocks/glazed_terracotta_black.png",[67,30,32]],["smithing table front","textures/blocks/smithing_table_front.png",[56,37,38]],["stripped cherry log side","textures/blocks/stripped_cherry_log_side.png",[215,145,148]],["red nether brick","textures/blocks/red_nether_brick.png",[69,7,9]],["deepslate redstone ore","textures/blocks/deepslate/deepslate_redstone_ore.png",[104,73,74]]
];

let hiddenBlocks = [];

// Modify the close button SVG icon in HTML accordingly.
let tipTimeout = setTimeout(function() {
    triggerPersistentMessage("&#128161; Click on a block to exclude it!", "rgb(100,80,125)");
}, 5000);

function refreshGradientLine(rgb1, rgb2, length, randomness, rowNumber) {

    for (let i = 0; i < length; i++) {
        const block = document.getElementById(`${rowNumber},${i}`);
        const percentage = i / (length - 1); // Calculate the interpolation percentage

        // Interpolate the base color between rgb1 and rgb2
        const baseColor = interpolateColors(rgb1, rgb2, Math.max(Math.min(percentage + (Math.random()-0.5)*randomness,1),0));

        // Set a default image source (you can change it to your desired URL)
        const closestIndex = findClosestColorIndex(baseColor, colorArray);
        const blockData = colorArray[closestIndex];
    
        block.src = 'https://raw.githubusercontent.com/ZtechNetwork/MCBVanillaResourcePack/master/' + colorArray[closestIndex][1];
        //block.src = '';
        block.style.backgroundColor = `rgb(${colorArray[closestIndex][2][0]}, ${colorArray[closestIndex][2][1]}, ${colorArray[closestIndex][2][2]})`;
        block.style.display = `block`;

        // Append the new image to the container

        // Add data attribute for the block name
        block.setAttribute('data-block-name', blockData[0]);

        // Add event listeners for hover
        block.addEventListener('mouseenter', function () {
            document.getElementById('blockNameDisplay').innerText = blockData[0];
            document.getElementById('clickToExcludeDisplay').innerText = "CLICK TO EXCLUDE";
        });

        block.addEventListener('mouseleave', function () {
            document.getElementById('blockNameDisplay').innerText = '';
            document.getElementById('clickToExcludeDisplay').innerText = "";
        });

        // Add click event for the next feature
        block.addEventListener('click', function () {
            openBlockModal(blockData);
        });
    }
    for (let i = length; i < 50; i++) {
        const block = document.getElementById(`${rowNumber},${i}`);
        block.style.display = `none`;

        // Append the new image to the container
    }
}

function refreshPreviewGradientLine(rgb1, rgb2, length, randomness, rowNumber) {

    for (let i = 0; i < length; i++) {
        const block = document.getElementById(`${rowNumber},${i}PREVIEW`);
        const percentage = i / (length - 1); // Calculate the interpolation percentage

        // Interpolate the base color between rgb1 and rgb2
        const baseColor = interpolateColors(rgb1, rgb2, Math.max(Math.min(percentage + (Math.random()-0.5)*randomness,1),0));

        // Set a default image source (you can change it to your desired URL)
        const closestIndex = findClosestColorIndex(baseColor, colorArray);
        block.style.color = `rgb(${colorArray[closestIndex][2][0]}, ${colorArray[closestIndex][2][1]}, ${colorArray[closestIndex][2][2]})`;
        block.style.display = `block`;

        // Append the new image to the container
    }
    for (let i = length; i < 50; i++) {
        const block = document.getElementById(`${rowNumber},${i}PREVIEW`);
        block.style.display = `none`;

        // Append the new image to the container
    }

}
  

function createDummyLine(rowNumber) {
    const blocksContainer = document.getElementById('blocksContainer')
    const rowContainer = document.createElement('div');
    rowContainer.classList.add('rowContainer');

    for (let i = 0; i < 50; i++) {
        const percentage = i / (length - 1); // Calculate the interpolation percentage

        // Interpolate the base color between rgb1 and rgb2
        const baseColor = interpolateColors(rgb1, rgb2, Math.max(Math.min(percentage + (Math.random()-0.5)*randomness,1),0));

        // Create a div for each color
        const newImage = document.createElement('img');

        newImage.src = '';
        newImage.classList.add('tinyBlock');
        newImage.id = `${rowNumber},${i}`;
        newImage.style.backgroundColor = `hsl(${rowNumber*20}, 100%, ${(i*10) % 100}%)`;

        // Append the new image to the container
        rowContainer.appendChild(newImage);
    }
    blocksContainer.appendChild(rowContainer);

}

function createDummyPreviewLine(rowNumber) {
    const blocksContainer = document.getElementById('blocksPreviewContainer')
    const rowContainer = document.createElement('div');
    rowContainer.classList.add('rowContainer');
    rowContainer.classList.add('rowContainer-preview');

    for (let i = 0; i < 50; i++) {
        const percentage = i / (length - 1); // Calculate the interpolation percentage

        // Interpolate the base color between rgb1 and rgb2
        const baseColor = interpolateColors(rgb1, rgb2, Math.max(Math.min(percentage + (Math.random()-0.5)*randomness,1),0));

        // Create a div for each color
        const newImage = document.createElement('div');

        newImage.src = '';
        newImage.classList.add('tinyBlock');
        newImage.classList.add('rowNumber'+rowNumber);
        newImage.id = `${rowNumber},${i}PREVIEW`;
        //newImage.style.backgroundColor = `hsl(${rowNumber*20}, 100%, ${(i*10) % 100}%)`;

        // Append the new image to the container
        rowContainer.appendChild(newImage);
    }
    blocksContainer.appendChild(rowContainer);

}

var rgb1 = [15,10,24];
var rgb2 = [130,123,119];
var length = 14; // Number of gradient steps
var randomness = 0.3; // Randomness factor (0 to 1)

function createDummyBlocks() {
    for (let i = 0; i < Math.ceil(innerWidth/20) + 1; i++) {
        createDummyLine(i);       
    }
}

function refreshGradient() {
    for (let i = 0; i < Math.ceil(innerWidth/20) + 1; i++) {
        refreshGradientLine(rgb1, rgb2, length, randomness, i);       
    }
}

function createDummyPreviewBlocks() {
    for (let i = 0; i < Math.ceil(innerWidth/20) + 1; i++) {
        
    }
    for (let i = 0; i < 5; i++) {
        createDummyPreviewLine(i);       
    }
}

let timeout;

function refreshPreviewGradient() {
    const blocksContainer = document.getElementById('blocksContainer');
    blocksContainer.style.visibility = "hidden";
    for (let i = 0; i < 5; i++) {
        refreshPreviewGradientLine(rgb1, rgb2, length, randomness, i);       
    }
    applyBoxShadows(result2DArray);
}

/*createDummyBlocks();
refreshGradient();*/


// Function to generate a random list of numbers
function generateRandomList(length, maxNumber) {
    const result = [];
    let previousNumber = -1;

    for (let i = 0; i < length; i++) {
        let randomNumber;
        do {
            randomNumber = Math.floor(Math.random() * (maxNumber + 1));
        } while (randomNumber === previousNumber);

        result.push(randomNumber);
        previousNumber = randomNumber;
    }

    return result;
}

// Function to create a 2D array based on the random list
function create2DArray(randomList, maxNumber) {
    // Initialize a 2D array with (maxNumber + 1) empty arrays
    const indexArray = Array.from({ length: maxNumber + 1 }, () => []);

    // Loop through the random list to populate the 2D array
    randomList.forEach((number, index) => {
        // Push the current index to the respective number's list
        indexArray[number].push(index);
    });

    return indexArray;
}

let result2DArray = [];

// Function to generate the random list and apply box shadows
function randomizePreview() {
    const maxNumber = 4; // Change this number to any maximum value you want
    const randomList = generateRandomList(Math.ceil(innerWidth/20)+1, maxNumber);
    result2DArray = create2DArray(randomList, maxNumber);
    applyBoxShadows(result2DArray);
}

// Function to generate and apply the box-shadow CSS
function applyBoxShadows(result2DArray) {
    // Find the internal stylesheet
    let styleSheet = null;
    for (let i = 0; i < document.styleSheets.length; i++) {
        const sheet = document.styleSheets[i];
        if (sheet.href === null || sheet.href.startsWith(window.location.origin)) {
            styleSheet = sheet;
            break;
        }
    }

    if (styleSheet) {
        result2DArray.forEach((row, index) => {
            const boxShadowValues = row.map(number => `${(number + 1) * 20}px 0`).join(', ');
            const cssRule = `.rowNumber${index} { box-shadow: ${boxShadowValues}; }`;

            styleSheet.insertRule(cssRule, styleSheet.cssRules.length);
        });
    } else {
        console.error('No suitable stylesheet found to insert rules.');
    }
}


function newPreviewGradient() {
    const blocksPreviewContainer = document.getElementById('blocksPreviewContainer');
    blocksPreviewContainer.innerHTML = '';
    createDummyPreviewBlocks();
    refreshPreviewGradient();
    randomizePreview();
}

function newGradient() {
    const blocksContainer = document.getElementById('blocksContainer');
    const loadingOverlay = document.getElementById('loadingOverlay');

    loadingOverlay.style.display = 'flex';

    // Allow the browser to render the loading overlay before heavy computations
    setTimeout(() => {
        blocksContainer.innerHTML = '';
        blocksContainer.style.visibility = 'visible';
        createDummyBlocks();
        refreshGradient();
        loadingOverlay.style.display = 'none';
    }, 50); // Delay of 50 milliseconds
}

newGradient();
setTimeout(() => {
    newPreviewGradient();
    document.getElementById('blocksContainer').style.visibility = 'visible';
}, 50); // Delay of 50 milliseconds
// newPreviewGradient();

let previousWidth = window.innerWidth;
let resizeTimeout;

setTimeout(function() {
    previousWidth = window.innerWidth;
}, 100);

window.addEventListener('resize', function() {
  clearTimeout(resizeTimeout); // Clear the previous timeout

  resizeTimeout = setTimeout(function() {
    const currentWidth = window.innerWidth;

    if (currentWidth !== previousWidth) {
      // Width has changed
      document.getElementById('loadingOverlay').style.display = 'flex';
      newPreviewGradient(); // Replace with your function call
      clearTimeout(timeout); // Clear any existing timeout
      timeout = setTimeout(newGradient, 3000);

      // Update the previous width to the current width
      previousWidth = currentWidth;
    }
  }, 10); // 150 milliseconds debounce delay
});


//window.addEventListener('resize', newPreviewGradient);

const lengthSlider = document.getElementById('LengthSlider');
const lengthInput = document.getElementById('LengthInput');
const randomnessSlider = document.getElementById('randomnessSlider');
const randomnessInput = document.getElementById('randomnessInput');

// Update length value and synchronize the controls
lengthSlider.addEventListener('input', function() {
    lengthInput.value = this.value;
    length = parseInt(this.value); // Update length variable
    console.log('length updated to:', length);
    refreshPreviewGradient();
});

lengthInput.addEventListener('input', function() {
    lengthSlider.value = this.value;
    length = parseInt(this.value); // Update length variable
    console.log('length updated to:', length);
    refreshPreviewGradient();
});

// Update randomness value and synchronize the controls
randomnessSlider.addEventListener('input', function() {
    const percentageValue = (this.value * 100).toFixed(0) + "%"; // Convert to percentage and add "%"
    randomnessInput.value = percentageValue;
    randomness = parseFloat(this.value); // Update randomness variable as decimal
    console.log('randomness updated to:', randomness);
    refreshPreviewGradient();
});

randomnessInput.addEventListener('input', function() {
    const cleanedValue = this.value.replace('%', ''); // Remove the "%" symbol
    const decimalValue = (cleanedValue / 100).toFixed(2); // Convert back to decimal
    randomnessSlider.value = decimalValue;
    randomness = parseFloat(decimalValue); // Update randomness variable as decimal
    console.log('randomness updated to:', randomness);
    refreshPreviewGradient();
});
function scrollBody(multiplier) {
    const startPosition = window.scrollY; // Current scroll position
    const endPosition = startPosition * multiplier; // Calculate the new scroll position by multiplying the current position
    const duration = 300; // Duration in milliseconds (0.3 seconds)
    let startTime = null;

    function animateScroll(currentTime) {
        if (!startTime) startTime = currentTime;
        const timeElapsed = currentTime - startTime;
        const progress = Math.min(timeElapsed / duration, 1); // Calculate progress within range [0, 1]
        
        const ease = (t) => t * (2 - t); // Ease function (ease-out)
        const newY = startPosition + (endPosition - startPosition) * ease(progress); // Calculate eased position
        
        window.scrollTo(0, newY);

        if (progress < 1) {
            requestAnimationFrame(animateScroll); // Continue animating
        }
    }

    requestAnimationFrame(animateScroll);
}


function zoomIn() {
    const element = document.querySelector('.blockScalerContainer');
    const style = window.getComputedStyle(element);
    const matrix = new WebKitCSSMatrix(style.transform);

    // Calculate the new scale by increasing it by 20%
    const newScale = matrix.a * 1.2; // Increase by 20%
    element.style.transform = `scale(${newScale})`;

    // Adjust the body's scroll position to keep the zoomed content in view
    scrollBody(1.2);
}

function zoomOut() {
    const element = document.querySelector('.blockScalerContainer');
    const style = window.getComputedStyle(element);
    const matrix = new WebKitCSSMatrix(style.transform);

    // Calculate the new scale by decreasing it by 20%
    let newScale = matrix.a * 0.8; // Decrease by 20%

    if (newScale < 1) {
        // If the new scale is less than 1, apply the rubber band effect
        element.style.transform = 'scale(1)';
        element.style.animation = 'rubberBand 0.3s ease'; // Apply the rubber band animation

        // Remove the animation after it completes
        element.addEventListener('animationend', function removeAnimation() {
            element.style.animation = ''; // Remove the animation to reset
            element.removeEventListener('animationend', removeAnimation);
        });
    } else {
        element.style.transform = `scale(${newScale})`;

        // Adjust the body's scroll position to keep the zoomed content in view
        scrollBody(0.8);
    }
}


let activeBlockButton = null; // To track which button was clicked
createGrid();

function adjustModalWidth() {
    const modal = document.getElementById('modal');
    const gridContainer = document.getElementById('gridContainer');
    const blockWidth = 40; // Width of each block in pixels
    const blockMargin = 10; // Margin around each block in pixels
    const margin = 30; // Padding for the modal in pixels

    // Calculate the available width for the modal
    const availableWidth = Math.min(window.innerWidth - 2 * margin, 18 * (blockMargin + blockWidth)); // Subtracting modal padding
    
    // Calculate the number of columns that fit within the available width
    const numColumns = Math.floor(availableWidth / (blockWidth + blockMargin));

    // Calculate the new width for the modal, rounding up to ensure it always fits the blocks
    const newModalWidth = numColumns * (blockWidth + blockMargin); // Add extra margin for Chrome rounding issues

    // Set the modal's width dynamically
    gridContainer.style.width = `${newModalWidth}px`;
    document.getElementById('modalHeader').style.width = `${newModalWidth}px`;
}

// Add event listener to adjust the modal width when the window is resized
window.addEventListener('resize', adjustModalWidth);

function openModal(blockButton) {
    filterBlocks();
    activeBlockButton = blockButton;
    adjustModalWidth(); // Adjust the modal width dynamically
    document.getElementById('overlay').style.display = 'block';
    // Select the element you want to scroll to the top
    const modal = document.getElementById('modal');

    // Set the scroll position to the top
    modal.style.display = 'flex';
    modal.scrollTop = 0;
}

function closeModal() {
    document.getElementById('modal').style.display = 'none';
    document.getElementById('overlay').style.display = 'none';
    document.getElementById('searchBar').value = '';
}

function createGrid() {
    const gridContainer = document.getElementById('gridContainer');
    gridContainer.innerHTML = ''; // Clear previous content if any

    colorArray.forEach((block) => {
        const gridBlock = document.createElement('img');
        gridBlock.className = 'gridBlock';
        gridBlock.src = 'https://raw.githubusercontent.com/ZtechNetwork/MCBVanillaResourcePack/master/' + block[1];
        gridBlock.setAttribute('data-name', block[0]); // Add data-name attribute for search filtering
        gridBlock.onclick = () => selectBlock(block); // Set the onclick event
        gridContainer.appendChild(gridBlock);
    });
}

function selectBlock(block) {
    const imgElement = activeBlockButton.querySelector('img');
    imgElement.src = 'https://raw.githubusercontent.com/ZtechNetwork/MCBVanillaResourcePack/master/' + block[1];

    if (activeBlockButton === document.querySelectorAll('.dropdownBtn')[0]) {
        rgb1 = block[2];
    } else {
        rgb2 = block[2];
    }

    closeModal();
        // Assuming you have these arrays and variables
    // Find the index of the block in colorArray
    let blockIndex = colorArray.indexOf(block);

    if (blockIndex !== -1) {
        // Check if the value in hiddenBlocks matches the index from colorArray
        if (hiddenBlocks.indexOf(blockIndex) !== -1) {
            // Remove the item at that index from hiddenBlocks
            hiddenBlocks.splice(hiddenBlocks.indexOf(blockIndex), 1);
            triggerMessage("Removed Excluded Block", "rgb(100,80,125)");
        }
    }
    
    updateHiddenBlocksDisplay();

    newPreviewGradient(); // Replace with your function call
    setTimeout(newGradient, 50);
}

function filterBlocks() {
    const searchQuery = document.getElementById('searchBar').value.toLowerCase();
    const gridBlocks = document.querySelectorAll('.gridBlock');

    gridBlocks.forEach(block => {
        const blockName = block.getAttribute('data-name').toLowerCase();
        if (blockName.includes(searchQuery)) {
            block.style.display = 'inline-block';
        } else {
            block.style.display = 'none';
        }
    });
}

document.querySelectorAll('.dropdownBtn').forEach(button => {
    button.addEventListener('click', function () {
        openModal(this);
    });
});

document.getElementById('overlay').addEventListener('click', closeModal);

let currentBlockData; // To keep track of the block in the modal

function openBlockModal(blockData) {
  clearTimeout(tipTimeout);
  currentBlockData = blockData;
  document.getElementById('modalBlockImage').src = 'https://raw.githubusercontent.com/ZtechNetwork/MCBVanillaResourcePack/master/' + blockData[1];
  document.getElementById('modalBlockName').innerText = blockData[0];
  document.getElementById('blockInfoModal').style.display = 'flex';
  document.getElementById('blockModalOverlay').style.display = 'block';
}

function closeBlockModal() {
  document.getElementById('blockInfoModal').style.display = 'none';
  document.getElementById('blockModalOverlay').style.display = 'none';
}

function hideBlock() {
    if (currentBlockData[2].toString() != rgb1.toString()) {
        if (currentBlockData[2].toString() != rgb2.toString()) {
            hiddenBlocks.push(colorArray.indexOf(currentBlockData));
            closeBlockModal();
            updateHiddenBlocksDisplay();
            newGradient();
        } else {
            triggerMessage("Can't Exclude The Ending Block Of The Gradient", "#f44336");
        }
    } else {
        triggerMessage("Can't Exclude The Starting Block Of The Gradient", "#f44336");
    }
    
}

function updateHiddenBlocksDisplay() {
    // Get the container to hold hidden block items
    const hiddenBlocksContainer = document.getElementById('hiddenBlocksContainer');
    hiddenBlocksContainer.innerHTML = ''; // Clear any existing blocks

    // Iterate through the hiddenBlocks array
    hiddenBlocks.forEach((index) => {
        // Create the div for the hidden block item
        const hiddenBlockItem = document.createElement('div');
        hiddenBlockItem.classList.add('hiddenBlockItem');

        // Create the img element
        const img = document.createElement('img');
        img.src = 'https://raw.githubusercontent.com/ZtechNetwork/MCBVanillaResourcePack/master/' + colorArray[index][1];

        // Create the button element
        const button = document.createElement('button');
        button.classList.add('deleteBtn');

        // Create the SVG inside the button
        const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
        svg.setAttribute('width', '10');
        svg.setAttribute('height', '4');

        const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
        line.setAttribute('x1', '0');
        line.setAttribute('y1', '2');
        line.setAttribute('x2', '10');
        line.setAttribute('y2', '2');
        line.setAttribute('stroke', 'black');
        line.setAttribute('stroke-width', '2');
        line.setAttribute('stroke-linecap', 'round');

        svg.appendChild(line);
        button.appendChild(svg);

        // Add click event to the delete button to remove the item
        button.addEventListener('click', () => {
            // Remove this block item from the DOM
            hiddenBlocksContainer.removeChild(hiddenBlockItem);

            // Remove the index from the hiddenBlocks array
            const blockIndex = hiddenBlocks.indexOf(index);
            if (blockIndex > -1) {
                hiddenBlocks.splice(blockIndex, 1);
            }
            newGradient();
        });

        // Append the img and button to the hidden block item div
        hiddenBlockItem.appendChild(img);
        hiddenBlockItem.appendChild(button);

        // Append the hidden block item to the container
        hiddenBlocksContainer.appendChild(hiddenBlockItem);
    });
}

// Variables to store timeouts
let showTimeout;
let hideTimeout;

function triggerMessage(message, color) {
    const errorMessage = document.getElementById('disappearingMessage');
    
    errorMessage.style.backgroundColor = color;

    // Clear any existing timeouts
    if (showTimeout) clearTimeout(showTimeout);
    if (hideTimeout) clearTimeout(hideTimeout);

    // Set the new message text
    errorMessage.innerHTML = message;

    // Show the error message

    errorMessage.classList.add('show');

    // Start the timeout to hide the message
    showTimeout = setTimeout(() => {
        errorMessage.classList.remove('show');

    }, 3000); // Time to show message
}


function triggerPersistentMessage(message, color) {
    const errorMessage = document.getElementById('persistentMessageContainer');
    
    errorMessage.style.backgroundColor = color;

    // Set the new message text
    document.getElementById('persistentMessage').innerHTML = message;

    errorMessage.classList.add('show');
}

function hidePersistentMessage() {
    const errorMessage = document.getElementById('persistentMessageContainer');

    errorMessage.classList.remove('show');
}


let isExpanded = true;

function toggleGradientController() {
  const controller = document.querySelector('.gradientController');
  const toggleButton = document.getElementById('toggleButton');

  if (isExpanded) {
    controller.classList.add('collapsed');
    controller.style.gap = '0';
    toggleButton.innerText = 'MORE';
  } else {
    controller.classList.remove('collapsed');
    controller.style.gap = '10px';
    toggleButton.innerText = 'LESS';
  }

  isExpanded = !isExpanded;
}

</script>

</body>

</html>
